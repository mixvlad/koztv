<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Start of month from date in MS SQL (opposite to EOMONTH function)</title>
    <link rel="icon" type="image/x-icon" href="../../static/img/logo.ico">

    <!-- Preconnects for external resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <!-- Font Awesome (loaded after initial render) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'">

    <!-- Site styles: preload for early fetch, standard link to avoid FOUC -->
    <link rel="preload" href="../../static/css/style.8b115c02.css" as="style">
    <link rel="stylesheet" href="../../static/css/style.8b115c02.css">
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XB3YH3ZZXT"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XB3YH3ZZXT');
    </script>
    
    <script>
        
    </script>

    <!-- Inline image loader script early to wrap images before they start downloading -->
    <script src="../../static/js/img-loader.4fd65a0f.js"></script>
</head>
<body class="">
    <header>
    <nav class="narrow">
        <a href="../../">Home</a>
        <a href="../../#projects">Projects</a>
        <a href="../../#blog">Blog</a>
    </nav>
</header> 
    
    <main>
        <article>
            
            <div class="content">
                <h1>Start of month from date in MS SQL (opposite to EOMONTH function)</h1>
                <div class="date">2016-10-08</div>
                <p>Sometimes we need to select values grouped by month from MS SQL Table. Probably the easiest way to do it is to call function DateAdd with DateDiff:</p>
<pre><code class="language-sql">SELECT Sum(YourColumn), DATEADD(month, DATEDIFF(month, 0, [YourDateColumn]), 0) as &#39;Date&#39;
FROM YourTable
GROUP BY DATEADD(month, DATEDIFF(month, 0, [YourDateColumn]), 0); 
</code></pre>
<p>Or we can use EOMONTH function that give us date that is the last day of the month:</p>
<pre><code class="language-sql">SELECT Sum(YourColumn),  EOMONTH([YourDateColumn]) as &#39;Date&#39;
FROM YourTable
GROUP BY EOMONTH([YourDateColumn]) ; 
</code></pre>
<p>But usually it’s just more convenient to use first day of month. So, if you want to save your time and make you script more clear, you can create you can create your own function, just like EOMONTH:</p>
<pre><code class="language-sql">SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[SOMONTH] (@dd datetime)
   RETURNS date

AS
BEGIN
    declare @YYYY_MM_DD datetime;
    
    SET @YYYY_MM_DD = DATEADD(month, DATEDIFF(month, 0, @dd), 0);   
    
    return @YYYY_MM_DD
END	
</code></pre>
<p>Now we can call it:</p>
<pre><code class="language-sql">SELECT Sum(YourColumn),  SOMONTH([YourDateColumn]) as &#39;Date&#39;
FROM YourTable
GROUP BY SOMONTH([YourDateColumn]) ; 
</code></pre>

            </div>
        </article>
    </main>

    <footer class="narrow">
    <p>© 2014 – 2025  Mike Koz<br><a href="mailto:m@koz.tv">m@koz.tv</a> </p>
</footer> 

    <script>
        if (document.fonts && document.fonts.ready) {
            document.fonts.ready.then(() => {
                document.querySelectorAll('.social-icons i').forEach(el => el.classList.add('fa-loaded'));
            });
        } else {
            window.addEventListener('load', () => {
                document.querySelectorAll('.social-icons i').forEach(el => el.classList.add('fa-loaded'));
            });
        }
    </script>
</body>
</html> 